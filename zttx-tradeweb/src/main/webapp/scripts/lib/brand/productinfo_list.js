function setMyCate(a){var b=$("#initCatalogSuper").val();$.ajax({type:"POST",url:"/brand/product/catalogTree",data:{brandesId:a},dataType:"json",cache:!1,success:function(a){var c="<option value=''>全部分类</option>",d="全部分类";$.each(a,function(a,e){b==e.id?(c+="<option selected='selected' value='"+e.id+"'>"+e.name+"</option>",d=e.name):c+="<option value='"+e.id+"'>"+e.name+"</option>",mycate[e.id]=e.children}),$("#catalogSuper").html(c),$("#catalogSuper_div span").text(d),$("#catalogSuper").change()}})}function setAjaxFormData(a){if(a)a=[a];else if(a=new Array,$("#list-table input.js_chk:checked").each(function(){a.push($(this).attr("id"))}),a.length<=0)return remind("error","请选择一个产品。"),!1;return $("#ajaxForm input[name='productIds']").remove(),$.each(a,function(a,b){$("#ajaxForm").append('<input type="hidden" name="productIds" value="'+b+'">')}),!0}function delProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否删除",function(){$.ajax({url:"/brand/product/ajax_delete",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){zttx.SUCCESS==a.code?(remind("success","操作成功！"),refresh()):remind("error",a.message)},error:function(a,b,c){remind("error",c)}})})}function returnProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否还原",function(){$.ajax({url:"/brand/product/ajax_return",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){126e3==a.code?(remind("success","还原产品成功"),refresh()):remind("error",a.message)},error:function(a,b,c){remind("error",c)}})})}function batchDelete(a){var b=setAjaxFormData(a);b&&confirmDialog("是否删除",function(){$.ajax({url:"/brand/product/batch_delete",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){126e3==a.code?(remind("success","删除产品成功"),refresh()):remind("error",a.message)},error:function(a,b,c){remind("error",c)}})})}function realDeleteProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否永久删除",function(){$.ajax({url:"/brand/product/ajax_delete_real",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){126e3==a.code?(remind("success","删除产品成功"),refresh()):remind("error",a.message)},error:function(a,b,c){remind("error",c)}})})}function groomProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否设置为推荐产品",function(){$.ajax({url:"/brand/product/ajax_groom",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){zttx.SUCCESS==a.code?(remind("success","推荐产品成功"),refresh()):remind("error",a.message)},error:function(a,b,c){remind("error",c)}})})}function ungroomProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否取消推荐产品",function(){$.ajax({url:"/brand/product/ajax_ungroom",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){126e3==a.code?remind("success","取消推荐成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function downProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否下架所选产品",function(){$.ajax({url:"/brand/product/ajax_down",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){zttx.SUCCESS==a.code?remind("success","下架成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function upProduct(a){var b=setAjaxFormData(a);b&&confirmDialog("是否上架所选产品",function(){$.ajax({url:"/brand/product/ajax_up",type:"post",data:$("#ajaxForm").serialize(),dataType:"json",success:function(a){126e3==a.code?remind("success","上架成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function upTabShow(a){var b=setAjaxFormData(a);b&&confirmDialog("是否前台显示所选产品",function(){$.ajax({url:"/brand/product/setShow",type:"post",data:$("#ajaxForm").serialize()+"&show=true&upTab=true",dataType:"json",success:function(a){126e3==a.code?remind("success","设置前台显示成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function upTabUnshow(a){var b=setAjaxFormData(a);b&&confirmDialog("是否前台不显示所选产品",function(){$.ajax({url:"/brand/product/setShow",type:"post",data:$("#ajaxForm").serialize()+"&show=false&upTab=true",dataType:"json",success:function(a){126e3==a.code?remind("success","设置前台不显示成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function downTabShow(a){var b=setAjaxFormData(a);b&&confirmDialog("是否前台显示所选产品",function(){$.ajax({url:"/brand/product/setShow",type:"post",data:$("#ajaxForm").serialize()+"&show=true&upTab=false",dataType:"json",success:function(a){126e3==a.code?remind("success","设置前台显示成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function downTabUnshow(a){var b=setAjaxFormData(a);b&&confirmDialog("是否前台不显示所选产品",function(){$.ajax({url:"/brand/product/setShow",type:"post",data:$("#ajaxForm").serialize()+"&show=false&upTab=false",dataType:"json",success:function(a){126e3==a.code?remind("success","设置前台不显示成功"):remind("error",a.message),refresh()},error:function(a,b,c){remind("error",c)}})})}function refresh(){page.render()}function tabSearch(a){$("#tabSearch").val(a),$("#search-form").submit()}function exportExcel(){var a="/brand/product/exportExcel?"+$("#search-form").serialize();window.open(a)}$(".checkallbox").on("click",".js-chkall",function(){$(this).parents(".checkallbox").next().find(".js_chk").prop("checked",this.checked)});var mycate=[];$(document).on("change","#catalogSuper",function(){$("#catalogSub").html(""),$("#catalogSub_div span").html("");var a=$("#initCatalogSub").val(),b=mycate[this.value];if(b&&0!=b.length){var c="",d="";$.each(b,function(b,e){a==e.id?(c+="<option selected='selected' value='"+e.id+"'>"+e.name+"</option>",d=e.name):c+="<option value='"+e.id+"'>"+e.name+"</option>"}),$("#catalogSub").html(c),""==d&&(d=$("#catalogSub option").eq(0).text()),$("#catalogSub_div span").text(d)}}),$(document).on("change","#brandsId",function(){setMyCate(this.value)}),$(function(){setMyCate($("#brandsId").val())});