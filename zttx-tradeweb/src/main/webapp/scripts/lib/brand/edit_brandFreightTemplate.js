function submitButton(){return $("#isExpressUsed").is(":checked")||$("#isExpressCollectUsed").is(":checked")||$("#isLogisticsCollectUsed").is(":checked")||$("#isLogisticsUsed").is(":checked")?void $("#fare-add-form").submit():void alert("请选择运送方式")}var shippingMethods={init:function(){this.initItem(),this.clickItem(),this.validatorForm(),this.inputChecking(),this.inputError()},initItem:function(){$(".js-edit-item").length>0&&$(".js-edit-item").each(function(){var a=$(this),b=a.parents(".js-edit-main");a.prop("checked")?(b.find(".js-edit-area").show(),b.find(".js-edit-area input").prop("disabled",!1)):(b.find(".js-edit-area").hide(),b.find(".js-edit-area input").prop("disabled",!0))})},clickItem:function(){var a=this;$(".js-edit-item").click(function(){a.initItem()}),$(".js-setarea-fare").click(function(){var a,b=$(this).parents(".js-edit-main"),c=b.find(".js-edit-item").attr("name"),d=b.find(".js-setarea-checkbox"),e=0;if(d&&d.length>0&&(e=parseInt(d.last().data("index"))+1),"isExpressUsed"==c&&(a="expressList"),"isLogisticsUsed"==c&&(a="logisticsList"),b.find(".js-edit-item").prop("checked")){b.find(".js-edit-areafare").show();var f=[];f.push("<tr>"),f.push("<td>"),f.push('<input type="checkbox" class="ui-checkbox js-setarea-checkbox mr5" data-index="'+e+'"'),b.find(".js-batch-operation").attr("clicked")||f.push('style="display: none;"'),f.push("/>"),f.push('<input type="hidden" name="'+a+"["+e+'].areaNos" />'),f.push('<a class="link fr js-edit" href="javascript:;">编辑</a><span style=\'display: inline-block;width: 207px;vertical-align: middle\'>未添加地区</span>'),f.push("</td>"),f.push('<td><input class="ui-input js-first-w" name="'+a+"["+e+'].firstWeight" type="text" data-min="0.001" data-max="9999999.999" style="width: 85px;" value="1.000"></td>'),f.push('<td><input class="ui-input js-first-p" name="'+a+"["+e+'].firstPrice" type="text" data-min="0.01" data-max="9999999.99" style="width: 85px;"></td>'),f.push('<td><input class="ui-input js-zen-w" name="'+a+"["+e+'].extendWeight" type="text" data-min="0.001" data-max="9999999.999" style="width: 85px;" value="1.000"></td>'),f.push('<td><input class="ui-input js-zen-p" name="'+a+"["+e+'].extendPrice" type="text" data-min="0.01" data-max="9999999.99" style="width: 85px;"></td>'),f.push('<td class="ta-c last">'),f.push('<a class="link js-setarea-delete" href="javascript:;">删除</a>'),f.push("</td>"),f.push("</tr>"),f=f.join(" "),b.find(".fare-table tbody").append(f)}}),$(".js-batch-operation").click(function(){var a=$(this).parents(".js-edit-main");a.find(".js-edit-areafare").is(":visible")&&($(this).attr("clicked")?($(this).html("批量操作").removeAttr("clicked"),a.find(".js-setarea-checkbox,.js-edit-batch").hide()):($(this).html("取消批量").attr("clicked","clicked"),a.find(".js-setarea-checkbox,.js-edit-batch").show()))}),$(".js-edit-checkall").click(function(){var a=$(this).parents(".js-edit-main");a.find(".js-setarea-checkbox").prop("checked",this.checked)});var b;seajs.use(["dialog","template"],function(c){var d=new c({trigger:$(".js-set-all"),content:$("#setAllTpl").html(),hasMask:!1,width:600}).after("show",function(a){b=$(a.activeTrigger).parents(".js-edit-main")});$(document).on("click",".js-cancel",function(){d.hide()}),$(document).on("click",".js-sure",function(){var c=$(".js-f-w").val(),e=$(".js-f-p").val(),f=$(".js-z-w").val(),g=$(".js-z-p").val();b.find(".js-edit-areafare .js-first-w").val(c),b.find(".js-edit-areafare .js-first-p").val(e),b.find(".js-edit-areafare .js-zen-w").val(f),b.find(".js-edit-areafare .js-zen-p").val(g),a._commonInputEach(),d.hide()})}),$(".js-delete-all").click(function(){var a=$(this).parents(".js-edit-main"),b=a.find(".js-setarea-checkbox:checked");return b.length<=0?void remind("error","请选择需要删除的地区"):void confirmDialog({title:"提示",content:"确认要删除所选地区的设置么？"},function(){b.parents("tr").remove()})}),$(".js-edit-areafare").on("click",".js-setarea-delete",function(){var a=$(this);confirmDialog({title:"提示",content:"确认要删除所选地区的设置么？"},function(){a.parents("tr").remove()})})},validatorForm:function(){var a=this;baseFormValidator({selector:"#fare-add-form",isAjax:!0,addElemFn:function(a,b){a.addItem({element:"#province",required:!0,errormessage:"请选择区域"})},beforeSubmitFn:function(){var b=$('select[name="province"]'),c=$('select[name="city"]'),d=$('select[name="county"]'),e=function(){var a=$.trim(b.val()),e=$.trim(c.val()),f=$.trim(d.val()),g="";return g=""==f?""==e?a:e:f},f=!0;f=a._commonInputEach(),f===!0&&$.ajax({url:"/brand/freightTemplate/saveBrandFreight",data:$("#fare-add-form").serialize()+"&template.areaNo="+e(),method:"post",success:function(a){a=$.parseJSON(a),a.code!=zttx.SUCCESS?remind("error",a.message):(remind("success","操作成功"),window.location.href="/brand/freightTemplate/list?isRecommend=0&productIds="+$("#productIds").val())}})}})},inputChecking:function(){var a=this;$(document).on("keyup change focusout",".js-weight,.js-first-w,.js-zen-w,.js-f-w,.js-z-w",function(b){a._checkingInput($(this),b,3)}),$(document).on("keyup change focusout",".js-input-price,.js-first-p,.js-zen-p,.js-f-p,.js-z-p",function(b){a._checkingInput($(this),b,2)})},_checkingInput:function(a,b,c){var d=a.val();d=d.replace(/[^\d.]/g,""),d=d.replace(/^\./g,""),d=d.replace(/\.{2,}/g,"."),d=d.replace(".","$#$").replace(/\./g,"").replace("$#$",".");var e=d.split(".");if(e[1]&&(d=e[0].toString()+"."+e[1].toString().substring(0,c)),a.val(d),"change"==b.type||"focusout"==b.type){var f=parseFloat(a.data("min")),g=parseFloat(a.data("max")),h=parseFloat(a.val());f&&g&&(f=Math.min(f,g),g=Math.max(f,g)),g&&h>g&&remind("error","最大值不能超过100000000"),f&&f>h&&remind("error","最小值不能低于0");var i=a.val();""!=i&&(i=parseFloat(i).toFixed(c),a.val(i))}},inputError:function(){$(".js-edit-main").on("keyup change focus",".ui-input",function(){var a=$(this).val(),b=$(this).data("min"),c=$(this).data("max");""!=a&&parseFloat(a)>=b&&parseFloat(a)<=c?$(this).removeClass("input-error-tip"):$(this).addClass("input-error-tip")})},_commonInputEach:function(){var a=!0;return $(".js-edit-main .ui-input:not(:disabled)").each(function(){var b=$(this).val(),c=$(this).data("min"),d=$(this).data("max");""!=b&&parseFloat(b)>=c&&parseFloat(b)<=d?$(this).removeClass("input-error-tip"):($(this).addClass("input-error-tip"),a=!1)}),a}};shippingMethods.init(),new setAreaCom({elem:".js-edit",confirmFn:function(a,b,c){a.next().html(c),a.prev().attr("value",b),a.data("value",b)},elemTiggerFn:function(a){var b=a.parents(".js-edit-main"),c=[],d=a.data("value");d&&"array"!==$.type(d)&&(d="["+d+"]",d=$.parseJSON(d)),$(".ts-select-city input[type=checkbox]").prop({disabled:!1,checked:!1}),$(".province-box").removeClass("hover"),b.find(".js-edit").each(function(){var a=$(this).data("value");a&&"array"!==$.type(a)&&(a="["+a+"]",a=$.parseJSON(a)),a&&(c=c.concat(a))});for(var e in c){var f=$("#city_value_"+c[e])[0];f.checked=!1,f.disabled=!0}if($(".ts-sc-content .province-box").each(function(){$(this).find(".province input[type=checkbox]").prop("disabled")&&$(this).find("input[name=areaAry]").prop({checked:!1,disabled:!0});var a=$(this).find("input[name=areaAry]").length,b=$(this).find("input[name=areaAry]:checked").length,c=$(this).find("input[name=areaAry]:disabled").length;a==b+c&&$(this).find(".province input[type=checkbox]").prop({disabled:!0,checked:!1})}),$(".ts-sc-content .ts-sc-gcity").each(function(){var a=$(this).find(".province .js-city").length,b=$(this).find(".province .js-city:disabled").length;a==b&&$(this).find(".gcity-box input").prop({disabled:!0,checked:!1})}),d)for(var g in d){var f=$("#city_value_"+d[g])[0];f.checked=!0,f.disabled=!1}$(".ts-sc-content .province-box").each(function(){$(this).find(".province input[type=checkbox]").prop("checked")&&$(this).find("input[name=areaAry]").prop({checked:!0,disabled:!1})})}});