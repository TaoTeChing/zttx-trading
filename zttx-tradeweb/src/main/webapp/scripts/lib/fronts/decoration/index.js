function uploadImage(a,b){seajs.use(["$","ajaxFileUpload"],function($){$.ajaxFileUpload({url:"/common/showImg",secureuri:!1,fileElementId:a,dataType:"json",success:function(c){126e3!=c.code?alert(c.message):$.isFunction(b)&&b(a,c.message,c.object)}})})}function showImage(a,b,c){var d=$("#"+a).data("img");$("#"+d).attr("src",window.IMAGE_DOMIAN+b),$("#"+d).siblings("input").eq(0).val(b)}function saveHeader(a,b,c){$.ajax({type:"POST",url:c,data:a.serialize(),dataType:"json",cache:!1,error:function(a,b,c){alert(c)},success:function(a){126e3!=a.code?alert(a.message):($("#header-navcen div[id^='headnav-']").hide(),1==b?resetHeader(a,"header"):2==b&&($("#headnav-custom div.customContent").html(UM.getEditor("myEditor2").getContent()),$("#headnav-custom").show(),0==$("#custom_style").size()&&$("#headnav-custom").append('<style id="custom_style">.header-nav {background: #fff;background-image: none;}.header-cen {background: #fff;height: 100%;}</style>')))}})}function setMenuData(){$("#menuData").empty(),$("#navUl li.movenav").each(function(a){var b="menus["+a+"]",c=$(this).data("id"),d=$(this).find("div.nav-edit-listate").text(),e=1,f=$(this).find("a.menu-link").text(),g=$(this).find("a.menu-link").attr("href");-1==d.indexOf("显示")&&(e=0),c&&""!=c&&$("#menuData").append("<input type='hidden' value='"+c+"' name='"+b+".id'> "),$("#menuData").append("<input type='hidden' value='"+e+"' name='"+b+".s'> "),$("#menuData").append("<input type='hidden' value='"+f+"' name='"+b+".n'> "),$("#menuData").append("<input type='hidden' value='"+g+"' name='"+b+".url'> ")})}function resetHeader(a,b){var c="/decoration/ajax_header/"+$("#brandsId").val();$.ajax({type:"POST",url:c,dataType:"json",cache:!1,error:function(a,b,c){alert(c)},success:function(c){if(126e3!=c.code)alert(c.message);else{var d=c.object;if("header"==b){$("#logoNameImg").attr("src",window.IMAGE_DOMIAN+d.logoName),$("#logoNameImg").siblings("input").val(d.logoName),$("#headerUrlImg").attr("src",window.IMAGE_DOMIAN+d.outBackUrl),$("#headerUrlImg").siblings("input").val(d.outBackUrl),$("#neibeiUploadImg").attr("src",window.IMAGE_DOMIAN+d.inBackUrl),$("#neibeiUploadImg").siblings("input").val(d.inBackUrl);var e=$(".js-logoname").val(),f=$(".js-mainpro").val(),g=$(".js-header-color").val(),h=$(".js-header-size option:selected").text();$("#headnav-defualt .logo h2").css({color:g,"font-size":h}),$("#headnav-defualt .logo h2").text(e),$("#headnav-defualt .logo h3").text(f);var i=$(".js-logoimgset").attr("src"),j=$(".js-headall").attr("src"),k=$(".js-headinner").attr("src"),l=k?k:"/images/market/temp/banar.jpg";$("head").append('<style>.header-nav{background:#BA2926 url(" '+j+'")}.header-navcen{background:url(" '+l+'")}.logo{background:url(" '+i+'");.header-cen {background: #fff;}</style>'),$(".js-logoname-tg").prop("checked")&&($("#headnav-defualt .logo").show(),$("#headnav-defualt .logo h2").show()),$(".js-logoimg-tg").prop("checked")&&($("#headnav-defualt .logo").show(),$("#headnav-defualt .logo h2").hide()),$("#headnav-defualt").show(),$("#custom_style").remove()}else{$("#navDefaultUrlImg").attr("src",window.IMAGE_DOMIAN+d.navDefaultUrl),$("#navDefaultUrlImg").siblings("input").val(d.navDefaultUrl),$("#navChangeUrlImg").attr("src",window.IMAGE_DOMIAN+d.navChangeUrl),$("#navChangeUrlImg").siblings("input").val(d.navChangeUrl);var m=$(".js-nav-bgcolor").val(),n=$(".js-nav-color").val(),o=$(".js-nav-hovercolor").val(),p=$(".js-navbg").attr("src"),q=$(".js-navhoverbg").attr("src"),r=$(".js-nav-hoverbgcolor").val(),s=$(".js-navselect-color").val();$(".nav-cen").css("backgroundColor",m),seajs.importStyle(".nav-cen{background: "+m+' url(" '+p+'");}a.menu-link{color:'+n+"}a.menu-link:hover{color:"+o+"}a.menu:hover{background:"+r+' url("'+q+'");}a.menu-link.selected{ background:'+s+";}");var t=$("#menu-list li").eq(0);$("#menu-list").empty(),$("#menu-list").append(t),$.each(a.rows,function(a,b){1==b.s&&$("#menu-list").append("<li class='menu'><a class='menu-link' href='"+b.url+"' title='"+b.n+"' ><span class='title'>"+b.n+"</span></a></li>")})}}}})}$(document).on("change","input[type='file']",function(){uploadImage(this.id,showImage)});